# Generated by Django 5.0.4 on 2024-06-27 16:07

from django.db import migrations


def fix_translations(apps, schema_editor):  # pragma: no cover
    TemplateTranslation = apps.get_model("templates", "TemplateTranslation")

    num_released = 0

    for trans in TemplateTranslation.objects.filter(is_active=True, channel__is_active=False):
        trans.is_active = False
        trans.save(update_fields=("is_active",))
        num_released += 1

    if num_released:
        print(f"Released {num_released} template translations for inactive channels")


class Migration(migrations.Migration):

    dependencies = [("templates", "0028_template_component_types")]

    operations = [migrations.RunPython(fix_translations, migrations.RunPython.noop)]
